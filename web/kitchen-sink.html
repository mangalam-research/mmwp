<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8"/>
    <link href="lib/external/font-awesome/css/font-awesome.min.css"
          type="text/css" media="screen" rel="stylesheet"/>
    <link href="lib/external/bootstrap/css/bootstrap.min.css"
          type="text/css" media="screen" rel="stylesheet"/>
    <link href="lib/wed/wed.css" type="text/css" media="screen"
          rel="stylesheet" />
    <script type="text/javascript" src="../ks/purl.js"></script>
    <script type="text/javascript" src="lib/external/classList.js"></script>
    <script type="text/javascript" src="lib/wed/polyfills/contains.js"></script>
    <script type="text/javascript" src="lib/wed/polyfills/matches.js"></script>
    <script type="text/javascript" src="lib/requirejs/require.js"></script>
    <script type="text/javascript" src="requirejs-config.js"></script>
  </head>
  <body>
    <div class="wed-widget container" id="widget"></div>
    <script>
      define("undefined", [], function () { return undefined; });
      var mode = purl().param('mode');
      var file = purl().param('file');
      var options_param = purl().param('options');

      var req = ["wed/wed", "jquery"];
      req.push(file ? "text!" + file : "undefined");

      require(req, function (wed, $, text) {
          $(function () {
              var $widget = $("#widget");
              if (text !== undefined)
                  $widget.html(text);
              var options = {};
              if (mode)
                  options.mode = { path: mode };

              if (options_param === "noautoinsert")
                  options.mode.options = { autoinsert: false };

              if (options_param === "ambiguous_fileDesc_insert")
                  options.mode.options = { ambiguous_fileDesc_insert: true };

              if (options_param === "fileDesc_insert_needs_input")
                  options.mode.options = { fileDesc_insert_needs_input: true };

              window.wed_editor = new wed.Editor();
              window.wed_editor.init($widget[0], options);
          });
      });
    </script>
  </body>
</html>
